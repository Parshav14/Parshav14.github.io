<pre>
%% Algorithm of Simplex Method to solve LPP <br>
%% <br>
% clc <br>
% clear all <br>
% format short <br>
% %To solve the LPP by Simplex Method <br>
% %Min z=x1-3x2+2x3 <br>
% %Subject to 3x1-x2+2x3<=7 <br>
% %-2x1+4x2<=12 <br>
% %-4x1+3x2+8x3<=10 <br>
% %x1,x2,x3>=0 <br>
% %First to change the objective function from minimization to maximization <br>
% %Max z=-x1+3x2-2x3 <br>
% %To input parameters <br>
% [info s b] <br>
% <br>
% To input Parameters <br>
C = [-1 3 -2]; <br>
info = [3 -1 2;-2 4 0;-4 3 8]; <br>
b = [7; 12; 10]; <br>
NOVariables = size(info,2); % x1,x2,x3 <br>
s = eye(size(info,1)); <br>
A = [info s b]; <br>
Cost = zeros(1,size(A,2)); <br>
Cost(1:NOVariables) = C; <br>
BV = NOVariables+1:size(A,2)-1; <br>
%To calculate Z-Row(Zj - Cj) <br>
ZRow = Cost(BV)*A-Cost; <br>
% To print the table <br>
ZjCj = [ZRow; A]; % First Column of Zj - Cj <br>
SimpleTable = array2table(ZjCj); <br>
SimpleTable.Properties.VariableNames(1:size(ZjCj,2))={'x_1','x_2','x_3','s_1','s_2','s_3','b'} <br>
% Simplex Table Starts <br>
Run = true; <br>
while Run <br>
if any(ZRow<0) % To check any negative value is there <br>
fprintf('The current BFS is not optimal\n'); <br>
fprintf('\n=======The next iteration continues======\n'); <br>
disp('Old Basic Variable(BV)=') <br>
disp(BV); <br>
% To find the entering variable <br>
ZC = ZRow(1:end-1); <br>
[EnterCol, Pvt_Col] = min(ZC); <br>
fprintf('The most negative element in Z-Row is %d Corresponding to Column %d \n',EnterCol,Pvt_Col); <br>
fprintf('Entering Variable is %d \n', Pvt_Col); <br>
% To find the leaving variable <br>
sol = A(:,end); <br>
Column = A(:,Pvt_Col); <br>
if all(Column<=0) <br>
error('LPP has unbounded solution. All entries<=0 in column %d',Pvt_Col) <br>
else <br>
% To check minimum ratio is with positive entering column <br>
% entries <br>
for i=1:size(Column,1) <br>
if Column(i)>0 <br>
ratio(i)=sol(i)./Column(i) <br>
else <br>
ratio(i) = inf <br>
end <br>
end <br>
% To find minimum ratio <br>
[MinRatio, Pvt_Row] = min(ratio) <br>
fprintf('Minimum ratio corresponding to pivot row is %d \n', Pvt_Row); <br>
fprintf('Leaving Variable is %d \n', BV(Pvt_Row)); <br>
end <br>
BV(Pvt_Row) = Pvt_Col; <br>
disp('Newe Basic Variable (BV) =') <br>
disp(BV) <br>
% Pivot Key <br>
Pvt_key = A(Pvt_Row,Pvt_Col); <br>
% Update table for next iteration <br>
A(Pvt_Row,:)=A(Pvt_Row,:)./Pvt_key <br>
for i=1:size(A,1) <br>
if i~=Pvt_Row <br>
A(i,:)=A(i,:)-A(i,Pvt_Col).*A(Pvt_Row,:) <br>
end <br>
ZRow=ZRow-ZRow(Pvt_Col).*A(Pvt_Row,:) <br>
%To print the updated table <br>
ZjCj=[ZRow;A] <br>
SimpTable=array2table(ZjCj) <br>
SimpTable.Properties.VariableNames(1:size(ZjCj,2))={'x_1','x_2','x_3','s_1','s_2','s_3','Sol'} <br>
BFS=zeros(1,size(A,2)) <br>
BFS(BV)=A(:,end) <br>
BFS(end)=sum(BFS.*Cost) <br>
CurrentBFS=array2table(BFS) <br>
CurrentBFS.Properties.VariableNames(1:size(CurrentBFS,2))={'x_1','x_2','x_3','s_1','s_2','s_3','Sol'} <br>
end <br>
else <br>
Run=false; <br>
fprintf('The current BFS is optimal and Optimality is reached\n') <br>
end <br>
end <br>
</pre>
